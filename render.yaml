services:
  # Web Service - Main Flask Application
  - type: web
    name: aegis-health-web
    env: python
    region: oregon  # Change to your preferred region (oregon, frankfurt, singapore, etc.)
    plan: free  # Change to 'starter' or 'standard' for production
    buildCommand: pip install -r requirements.txt
    startCommand: gunicorn "flask_app:app" --bind 0.0.0.0:$PORT --workers 2 --timeout 120
    envVars:
      - key: DEMO_SMS
        value: false
      - key: FLASK_ENV
        value: production
      - key: TWILIO_ACCOUNT_SID
        sync: false  # Set this manually in Render dashboard
      - key: TWILIO_AUTH_TOKEN
        sync: false  # Set this manually in Render dashboard
      - key: TWILIO_PHONE_NUMBER
        sync: false  # Set this manually in Render dashboard

  # Background Worker - Automated Hourly Alerts
  - type: worker
    name: aegis-health-alert-worker
    env: python
    region: oregon  # Same region as web service
    plan: free
    buildCommand: pip install -r requirements.txt
    startCommand: python send_alerts.py
    envVars:
      - key: DEMO_SMS
        value: false
      - key: TWILIO_ACCOUNT_SID
        sync: false  # Set this manually in Render dashboard
      - key: TWILIO_AUTH_TOKEN
        sync: false  # Set this manually in Render dashboard
      - key: TWILIO_PHONE_NUMBER
        sync: false  # Set this manually in Render dashboard
